# System Architecture Block Diagram

## Complete Drone Telemetry Control System

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    DRONE TELEMETRY CONTROL SYSTEM                               │
│                                     (Real-Time GPS Navigation)                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                      HARDWARE LAYER                                               │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

     ┌─────────────────────┐                    ┌─────────────────────┐
     │   GPS MODULE        │                    │   COMPUTER/LAPTOP   │
     │   (Hardware)        │                    │   (Ground Control)   │
     ├─────────────────────┤                    ├─────────────────────┤
     │ • NEO-6M/7M/8M      │                    │ • Windows/Linux/Mac │
     │ • Satellite Rx      │                    │ • Chrome/Edge       │
     │ • NMEA Protocol     │                    │ • USB Port          │
     │ • 115200 Baud       │                    │ • Web Serial API    │
     └──────────┬──────────┘                    └──────────┬──────────┘
                │                                          │
                │ UART2 (GPIO 4/2)                         │ USB Cable
                │ TX/RX @ 115200                           │
                │                                          │
                ▼                                          ▼
     ┌──────────────────────────────────────────────────────────────┐
     │              ESP32 MICROCONTROLLER                           │
     │              (Central Processing Unit)                       │
     ├──────────────────────────────────────────────────────────────┤
     │  UART0: Serial Monitor (Debug)        GPIO 1/3               │
     │  UART1: Web Serial API (Control)      GPIO 16/17             │
     │  UART2: GPS Module (Telemetry)        GPIO 4/2               │
     └──────────────────────────────────────────────────────────────┘
                                │
                                │
                                ▼


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    FIRMWARE LAYER (ESP32)                                         │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                 │
│   ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐                         │
│   │  GPS PARSER     │      │  MISSION ENGINE │      │  UART HANDLER   │                         │
│   │  (TinyGPS++)    │      │  (State Machine)│      │  (ArduinoJson)  │                         │
│   ├─────────────────┤      ├─────────────────┤      ├─────────────────┤                         │
│   │ • Parse NMEA    │◄────►│ • WAITING       │◄────►│ • JSON Parser   │                         │
│   │ • Extract Lat   │      │ • LOADED        │      │ • Command Proc  │                         │
│   │ • Extract Lng   │      │ • NAVIGATING    │      │ • Data Sender   │                         │
│   │ • Calculate     │      │ • COMPLETE      │      │ • Serial I/O    │                         │
│   │   Speed/Course  │      │                 │      │                 │                         │
│   └────────┬────────┘      └────────┬────────┘      └────────┬────────┘                         │
│            │                         │                         │                                │
│            │                         │                         │                                │
│            └─────────────────────────┼─────────────────────────┘                                │
│                                      │                                                          │
│                                      ▼                                                          │
│                          ┌───────────────────────┐                                              │
│                          │  WAYPOINT MANAGER     │                                              │
│                          ├───────────────────────┤                                              │
│                          │ • Store 20 Waypoints  │                                              │
│                          │ • Distance Calc       │                                              │
│                          │ • Progress Tracking   │                                              │
│                          │ • Completion Check    │                                              │
│                          └───────────────────────┘                                              │
│                                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      │ Web Serial API (UART1)
                                      │ JSON Messages @ 115200 Baud
                                      │
                                      ▼


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  COMMUNICATION PROTOCOL                                           │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

                    ESP32 → Browser (Telemetry Stream)
                    ═══════════════════════════════════
                    
        ┌───────────────────────────────────────────────────────┐
        │  {"type": "telemetry",                                │
        │   "lat": 16.990200, "lng": 73.312000,                 │
        │   "alt": 45.5, "sat": 12, "speed": 15.2,              │
        │   "direction": 135, "timestamp": 1234567890}          │
        └───────────────────────────────────────────────────────┘
                              │
                              │ Every 2 seconds
                              │
                              ▼
        
        ┌───────────────────────────────────────────────────────┐
        │  {"type": "navigation_update",                        │
        │   "status": "waypoint_reached",                       │
        │   "current_waypoint_index": 1,                        │
        │   "accuracy_meters": 3.2}                             │
        └───────────────────────────────────────────────────────┘
                              │
                              │ Event-driven
                              │
                              ▼


                    Browser → ESP32 (Mission Commands)
                    ═══════════════════════════════════
                    
        ┌───────────────────────────────────────────────────────┐
        │  {"action": "start_mission",                          │
        │   "waypoints": [                                      │
        │     {"name": "WP1", "latitude": 16.991,               │
        │      "longitude": 73.313, "altitude": 50}             │
        │   ],                                                  │
        │   "max_speed": 20.0, "return_to_home": true}          │
        └───────────────────────────────────────────────────────┘
                              │
                              │ User-initiated
                              │
                              ▼
        
        ┌───────────────────────────────────────────────────────┐
        │  {"action": "emergency_stop"}                         │
        │  {"action": "return_home"}                            │
        │  {"action": "get_status"}                             │
        └───────────────────────────────────────────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  FRONTEND LAYER (Browser)                                          │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    WEB APPLICATION                                              │
│                                                                                                 │
│   ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐                         │
│   │  UI CONTROLLER  │      │  MAP ENGINE     │      │  SERIAL MANAGER │                         │
│   │  (ui.js)        │      │  (map.js)       │      │  (main.js)      │                         │
│   ├─────────────────┤      ├─────────────────┤      ├─────────────────┤                         │
│   │ • Button Events │◄────►│ • Leaflet.js    │◄────►│ • Web Serial    │                         │
│   │ • Status Update │      │ • Satellite Map │      │ • Port Connect  │                         │
│   │ • Log Display   │      │ • Markers       │      │ • Data Parser   │                         │
│   │ • Theme Toggle  │      │ • Polylines     │      │ • JSON Handler  │                         │
│   └────────┬────────┘      └────────┬────────┘      └────────┬────────┘                         │
│            │                         │                         │                                │
│            └─────────────────────────┼─────────────────────────┘                                │
│                                      │                                                          │
│                                      ▼                                                          │
│                          ┌───────────────────────┐                                              │
│                          │  MISSION CONTROLLER   │                                              │
│                          │  (mission.js)         │                                              │
│                          ├───────────────────────┤                                              │
│                          │ • Waypoint Manager    │                                              │
│                          │ • Mission Builder     │                                              │
│                          │ • Progress Tracker    │                                              │
│                          │ • ETA Calculator      │                                              │
│                          └───────────────────────┘                                              │
│                                      │                                                          │
│                                      ▼                                                          │
│                          ┌───────────────────────┐                                              │
│                          │  TELEMETRY DISPLAY    │                                              │
│                          │  (telemetry.js)       │                                              │
│                          ├───────────────────────┤                                              │
│                          │ • GPS Data Display    │                                              │
│                          │ • Real-time Updates   │                                              │
│                          │ • Status Indicators   │                                              │
│                          │ • Navigation Info     │                                              │
│                          └───────────────────────┘                                              │
│                                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    DATA FLOW DIAGRAM                                              │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

    GPS Satellite                                                          User Interface
         │                                                                       │
         │ NMEA Sentences                                                       │ Click Events
         │ @ 1Hz                                                                │
         ▼                                                                       ▼
    ┌─────────┐         ┌──────────┐         ┌──────────┐         ┌────────────────┐
    │   GPS   │ UART2   │          │ UART1   │  Web     │  HTTP   │   Browser      │
    │ Module  │────────►│  ESP32   │◄───────►│ Serial   │◄───────►│   Frontend     │
    │         │ 115200  │ Firmware │ 115200  │   API    │         │   (HTML/JS)    │
    └─────────┘         └──────────┘         └──────────┘         └────────────────┘
         │                    │                     │                      │
         │                    │                     │                      │
         │                    ▼                     │                      ▼
         │            ┌───────────────┐             │              ┌──────────────┐
         │            │ Mission State │             │              │ Map Display  │
         │            │   Machine     │             │              │ (Leaflet.js) │
         │            └───────────────┘             │              └──────────────┘
         │                    │                     │                      │
         │                    ▼                     │                      │
         │            ┌───────────────┐             │                      │
         │            │  Waypoint     │             │                      │
         │            │  Navigation   │             │                      │
         │            └───────────────┘             │                      │
         │                    │                     │                      │
         └────────────────────┴─────────────────────┴──────────────────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  Real-time       │
                    │  Telemetry Data  │
                    └──────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  MISSION EXECUTION FLOW                                           │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

    Browser                          ESP32                           GPS Module
       │                               │                                  │
       │  1. Connect Serial            │                                  │
       ├──────────────────────────────►│                                  │
       │                               │                                  │
       │  2. System Ready              │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │                               │  3. GPS Data Stream              │
       │                               │◄─────────────────────────────────┤
       │                               │                                  │
       │  4. Telemetry (every 2s)      │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │  5. Start Mission (JSON)      │                                  │
       ├──────────────────────────────►│                                  │
       │                               │                                  │
       │                               │  6. Load Waypoints               │
       │                               │  [State: LOADED]                 │
       │                               │                                  │
       │  7. Mission Confirmation      │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │                               │  8. Start Navigation             │
       │                               │  [State: NAVIGATING]             │
       │                               │                                  │
       │  9. Navigation Started        │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │  10. Telemetry + Nav Updates  │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │                               │  11. Check Distance              │
       │                               │  (Haversine Formula)             │
       │                               │                                  │
       │  12. Waypoint Reached         │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │                               │  13. Next Waypoint               │
       │                               │  [Index++]                       │
       │                               │                                  │
       │  14. Navigating To Next       │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │  15. Mission Complete         │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │
       │                               │  16. Return Home (Optional)      │
       │                               │  [State: COMPLETE]               │
       │                               │                                  │
       │  17. Returning Home           │                                  │
       │◄──────────────────────────────┤                                  │
       │                               │                                  │


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    STATE MACHINE DIAGRAM                                          │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

                                ┌─────────────────┐
                                │   POWER ON      │
                                └────────┬────────┘
                                         │
                                         ▼
                                ┌─────────────────┐
                         ┌─────►│    WAITING      │◄─────┐
                         │      │  FOR MISSION    │      │
                         │      └────────┬────────┘      │
                         │               │               │
                         │               │ Receive       │
                         │               │ Mission       │
                         │               │               │
                         │               ▼               │
                         │      ┌─────────────────┐      │
                         │      │  MISSION        │      │
                         │      │  LOADED         │      │
                         │      └────────┬────────┘      │
                         │               │               │
                         │               │ Start         │
                         │               │ Navigation    │
                         │               │               │
                         │               ▼               │
                         │      ┌─────────────────┐      │
                         │      │   NAVIGATING    │      │
                         │      │  (Active Flight)│      │
                         │      └────────┬────────┘      │
                         │               │               │
                         │               │ All WPs       │
                         │               │ Reached       │
                         │               │               │
                         │               ▼               │
                         │      ┌─────────────────┐      │
                         └──────┤   MISSION       │      │
                                │   COMPLETE      │──────┘
                                └─────────────────┘
                                         │
                                         │ Reset
                                         │
                                         ▼
                                ┌─────────────────┐
                                │  READY FOR      │
                                │  NEXT MISSION   │
                                └─────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  KEY SYSTEM FEATURES                                              │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────┐  ┌──────────────────────────┐  ┌──────────────────────────┐
│   REAL-TIME TRACKING     │  │   MISSION CONTROL        │  │   DUAL UART SYSTEM       │
├──────────────────────────┤  ├──────────────────────────┤  ├──────────────────────────┤
│ • 2s GPS Updates         │  │ • Waypoint Navigation    │  │ • UART0: Debug Monitor   │
│ • Live Position          │  │ • Sequential Execution   │  │ • UART1: Web Serial API  │
│ • Speed & Heading        │  │ • Progress Tracking      │  │ • UART2: GPS Module      │
│ • Satellite Count        │  │ • Return-to-Home         │  │ • 115200 Baud Rate       │
│ • Map Visualization      │  │ • Emergency Stop         │  │ • JSON Protocol          │
└──────────────────────────┘  └──────────────────────────┘  └──────────────────────────┘

┌──────────────────────────┐  ┌──────────────────────────┐  ┌──────────────────────────┐
│   WEB SERIAL API         │  │   STATE MANAGEMENT       │  │   DISTANCE CALCULATION   │
├──────────────────────────┤  ├──────────────────────────┤  ├──────────────────────────┤
│ • Direct USB Connection  │  │ • WAITING                │  │ • Haversine Formula      │
│ • No Server Required     │  │ • LOADED                 │  │ • 5m Waypoint Radius     │
│ • Low Latency (<100ms)   │  │ • NAVIGATING             │  │ • Real-time Distance     │
│ • Chrome/Edge Support    │  │ • COMPLETE               │  │ • Accuracy Tracking      │
│ • Bidirectional Comms    │  │ • Mission Confirmation   │  │ • ETA Calculation        │
└──────────────────────────┘  └──────────────────────────┘  └──────────────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  TECHNOLOGY STACK                                                 │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

    Hardware                Firmware                Frontend                Libraries
    ════════                ════════                ════════                ═════════
    
    • ESP32                 • Arduino C++           • HTML5                 • TinyGPSPlus
    • GPS Module            • TinyGPSPlus           • JavaScript ES6        • ArduinoJson
    • USB Cable             • ArduinoJson           • CSS3                  • Leaflet.js
    • Computer              • HardwareSerial        • Web Serial API        • Font Awesome
                            • State Machine         • Leaflet Maps          • Google Maps API


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  PERFORMANCE METRICS                                              │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────────────────────────────────────────────────────────┐
    │  Update Rates:                                                              │
    │  • GPS Telemetry:        2000ms (0.5 Hz)                                    │
    │  • Navigation Updates:   Event-driven (< 200ms)                             │
    │  • Status Updates:       10000ms (0.1 Hz)                                   │
    │  • Command Response:     < 100ms                                            │
    │                                                                             │
    │  Accuracy:                                                                  │
    │  • GPS Position:         ±2.5m (with good signal)                           │
    │  • Waypoint Radius:      5.0m (configurable)                                │
    │  • Speed Accuracy:       ±0.5 km/h                                          │
    │  • Altitude Accuracy:    ±5m                                                │
    │                                                                             │
    │  Capacity:                                                                  │
    │  • Max Waypoints:        20 per mission                                     │
    │  • Max Speed:            25 km/h                                            │
    │  • Max Altitude:         120m                                               │
    │  • Mission Storage:      Single active mission                              │
    └─────────────────────────────────────────────────────────────────────────────┘


┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    DEVELOPER INFORMATION                                           │
└───────────────────────────────────────────────────────────────────────────────────────────────────┘

    ╔═══════════════════════════════════════════════════════════════════════════════════════╗
    ║                                                                                       ║
    ║                          🔒 DEVELOPED BY MADHAV SAWANT 🔒                            ║
    ║                                                                                       ║
    ║                    Drone Telemetry Control System - Version 1.0                      ║
    ║                                                                                       ║
    ║                    This system architecture is protected and locked                  ║
    ║                                                                                       ║
    ╚═══════════════════════════════════════════════════════════════════════════════════════╝


═══════════════════════════════════════════════════════════════════════════════════════════════════
                            END OF SYSTEM ARCHITECTURE DIAGRAM
═══════════════════════════════════════════════════════════════════════════════════════════════════
